"use strict";(self.webpackChunkdocs2=self.webpackChunkdocs2||[]).push([[946],{1556:(s,n,a)=>{a.r(n),a.d(n,{data:()=>e});const e={key:"v-24f2d5ba",path:"/network/",title:"Network",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Quickstart",slug:"quickstart",children:[]},{level:2,title:"Joining Mainnet",slug:"joining-mainnet",children:[]},{level:2,title:"Joining Testnet",slug:"joining-testnet",children:[]},{level:2,title:"Relayers",slug:"relayers",children:[]}],filePathRelative:"network/README.md",git:{contributors:[{name:"Czarcas7ic",email:"adamleetucker@outlook.com",commits:1}]}}},6512:(s,n,a)=>{a.r(n),a.d(n,{default:()=>t});const e=(0,a(6252).uE)('<h1 id="network" tabindex="-1"><a class="header-anchor" href="#network" aria-hidden="true">#</a> Network</h1><h2 id="quickstart" tabindex="-1"><a class="header-anchor" href="#quickstart" aria-hidden="true">#</a> Quickstart</h2><p><em>(Note: This repository is under active development. Architecture and implementation may change without documentation)</em></p><p>This is what you&#39;d use to get a node up and running, fast. It assumes that it is starting on a blank ubuntu machine. It eschews a systemd unit, allowing automation to be up to the user. It assumes that installing Go is in-scope since Ubuntu&#39;s repositories aren&#39;t up to date and you&#39;ll be needing go to use osmosis. It handles the Go environment variables because those are a common pain point.</p><p><strong>Install go</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">wget</span> -q -O - https://git.io/vQhTU <span class="token operator">|</span> <span class="token function">bash</span> -s -- --version <span class="token number">1.17</span>.2\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then exit and re-enter your shell.</p><p><strong>Install Osmosis and check that it is on $PATH</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/osmosis-labs/osmosis\n<span class="token builtin class-name">cd</span> osmosis\n<span class="token function">git</span> checkout v3.1.0\n<span class="token function">make</span> <span class="token function">install</span>\n<span class="token function">which</span> osmosisd\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Launch Osmosis</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>osmosisd init yourmonikerhere\n<span class="token function">wget</span> -O ~/.osmosisd/config/genesis.json https://github.com/osmosis-labs/networks/raw/main/osmosis-1/genesis.json\nosmosisd start\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>More Nodes ==&gt; More Network</p><p>More Network ==&gt; Faster Sync</p><p>Faster Sync ==&gt; Less Developer Friction</p><p>Less Developer Friction ==&gt; More Osmosis</p><p>Thank you for supporting a healthy blockchain network and community by running an Osmosis node!</p><h2 id="joining-mainnet" tabindex="-1"><a class="header-anchor" href="#joining-mainnet" aria-hidden="true">#</a> Joining Mainnet</h2><h2 id="joining-testnet" tabindex="-1"><a class="header-anchor" href="#joining-testnet" aria-hidden="true">#</a> Joining Testnet</h2><p>Start by ensuring your system is up to date:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> update\n<span class="token function">sudo</span> <span class="token function">apt</span> upgrade\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Install tools if not already installed (git, gcc, make, etc.):</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">git</span> build-essential ufw <span class="token function">curl</span> jq snapd --yes\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Install go:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">wget</span> -q -O - https://git.io/vQhTU <span class="token operator">|</span> <span class="token function">bash</span> -s -- --version <span class="token number">1.17</span>.2\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>After installed, open new terminal to properly load go</p><p>Run the following to clone the osmosis repo:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>\n<span class="token function">git</span> clone https://github.com/osmosis-labs/osmosis\n<span class="token builtin class-name">cd</span> osmosis\n<span class="token function">git</span> checkout v3.2.0_with_cache\n<span class="token function">make</span> <span class="token function">install</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>You have now installed the Osmosis Daemon (osmosisd). Use osmosisd to initialize your node with the following (replace the NODE_NAME with a name of your choosing):</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>osmosisd init NODE_NAME --chain-id<span class="token operator">=</span>osmosis-testnet-0\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We now need to open the config.toml to edit the seed list with the following:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/.osmosisd/config\n<span class="token function">nano</span> config.toml\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Use page down or arrow keys to get to the line that says seeds = &quot;&quot; and replace it with the following:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>seeds <span class="token operator">=</span> <span class="token string">&quot;4eaed17781cd948149098d55f80a28232a365236@testmosis.blockpane.com:26656&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then pres Ctrl+O, then enter to save, then Ctrl+X to exit</p><p>We will now set up cosmovisor to ensure the upgrade happens flawlessly. To install Cosmovisor:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>\n<span class="token function">git</span> clone https://github.com/cosmos/cosmos-sdk\n<span class="token builtin class-name">cd</span> cosmos-sdk\n<span class="token function">git</span> checkout v0.42.9\n<span class="token function">make</span> cosmovisor\n<span class="token function">cp</span> cosmovisor/cosmovisor <span class="token variable">$GOPATH</span>/bin/cosmovisor\n<span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>After this, create the required directories with the following commands:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> -p ~/.osmosisd/cosmovisor\n<span class="token function">mkdir</span> -p ~/.osmosisd/cosmovisor/genesis\n<span class="token function">mkdir</span> -p ~/.osmosisd/cosmovisor/genesis/bin\n<span class="token function">mkdir</span> -p ~/.osmosisd/cosmovisor/upgrades\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Next, run the following commands to set the environment variables:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;# Setup Cosmovisor&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">echo</span> <span class="token string">&quot;export DAEMON_NAME=osmosisd&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">echo</span> <span class="token string">&quot;export DAEMON_HOME=<span class="token environment constant">$HOME</span>/.osmosisd&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">echo</span> <span class="token string">&quot;export DAEMON_ALLOW_DOWNLOAD_BINARIES=false&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">echo</span> <span class="token string">&quot;export DAEMON_LOG_BUFFER_SIZE=512&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">echo</span> <span class="token string">&quot;export DAEMON_RESTART_AFTER_UPGRADE=true&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.profile\n<span class="token builtin class-name">source</span> ~/.profile\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Download and replace the genesis file:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/.osmosisd/config\n<span class="token function">wget</span> https://github.com/osmosis-labs/networks/raw/unity/v4/osmosis-1/upgrades/v4/testnet/genesis.tar.bz2\n<span class="token function">tar</span> -xjf genesis.tar.bz2\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Next, copy the current osmosisd binary into the cosmovisor/genesis folder:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> <span class="token variable">$GOPATH</span>/bin/osmosisd ~/.osmosisd/cosmovisor/genesis/bin\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>To check your work, ensure the version of cosmovisor and osmosisd are the same:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>cosmovisor version\nosmosisd version\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>These two command should both output 3.1.0-23-g517562d</p><p>Before we start cosmovisor, lets prep the upgrade to v4.0.0-rc1:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> -p ~/.osmosisd/cosmovisor/upgrades/v4/bin\n<span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/osmosis\n<span class="token function">git</span> checkout v4.0.0-rc1\n<span class="token function">make</span> build\n<span class="token function">cp</span> build/osmosisd ~/.osmosisd/cosmovisor/upgrades/v4/bin\n<span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Use the following command to ensure the validator file is in the gensesis state:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>osmosisd unsafe-reset-all\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>While we could start cosmovisor now with &quot;cosmovisor start&quot;, lets set up a service to allow cosmovisor to run in the background as well as restart automatically if it runs into any problems:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;[Unit]\nDescription=Cosmovisor daemon\nAfter=network-online.target\n[Service]\nEnvironment=&quot;</span><span class="token assign-left variable">DAEMON_NAME</span><span class="token operator">=</span>osmosisd<span class="token string">&quot;\nEnvironment=&quot;</span><span class="token assign-left variable">DAEMON_HOME</span><span class="token operator">=</span><span class="token variable">${<span class="token environment constant">HOME</span>}</span>/.osmosisd<span class="token string">&quot;\nEnvironment=&quot;</span><span class="token assign-left variable">DAEMON_RESTART_AFTER_UPGRADE</span><span class="token operator">=</span>true<span class="token string">&quot;\nEnvironment=&quot;</span><span class="token assign-left variable">DAEMON_ALLOW_DOWNLOAD_BINARIES</span><span class="token operator">=</span>false<span class="token string">&quot;\nEnvironment=&quot;</span><span class="token assign-left variable">DAEMON_LOG_BUFFER_SIZE</span><span class="token operator">=</span><span class="token number">512</span><span class="token string">&quot;\nUser=<span class="token environment constant">$USER</span>\nExecStart=<span class="token variable">${<span class="token environment constant">HOME</span>}</span>/go/bin/cosmovisor start\nRestart=always\nRestartSec=3\nLimitNOFILE=4096\n[Install]\nWantedBy=multi-user.target\n&quot;</span> <span class="token operator">&gt;</span>cosmovisor.service\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Move this new file to the systemd directory:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mv</span> cosmovisor.service /lib/systemd/system/cosmovisor.service\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Finally, reload and start the service:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl daemon-reload\n<span class="token function">sudo</span> systemctl start cosmovisor\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Check the status of your service:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl status cosmovisor\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>To see live logs of your service:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>journalctl -u cosmovisor -f\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>The process should initialize and get to block 1122200, where it will automatically upgrade to v4.0.0-rc1</p><p>At around block height 1128853, when reading the logs you will see many notifications of &quot;slashing and jailing validator&quot;. This is due to fact that many validators did not participate in the testnet and therefore get jailed at the same time (approx 30,000 blocks after the upgrade). In my experience, this may cause your node to reset due to a memory error. As long as you set up the service above, it will automatically reset and eventually get passed this difficult block.</p><p>Guide as of 15 November 2021.</p><h2 id="relayers" tabindex="-1"><a class="header-anchor" href="#relayers" aria-hidden="true">#</a> Relayers</h2>',65),o={},t=(0,a(3744).Z)(o,[["render",function(s,n){return e}]])},3744:(s,n)=>{n.Z=(s,n)=>{const a=s.__vccOpts||s;for(const[s,e]of n)a[s]=e;return a}}}]);